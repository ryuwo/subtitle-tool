<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìë§‰ ì˜¤ì—­ ìˆ˜ì • ë„êµ¬</title>
    
    <!-- CORS ì •ì±… ì„¤ì • -->
    <meta http-equiv="Cross-Origin-Embedder-Policy" content="require-corp">
    <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- ê¸°ì¡´ body ë‚´ìš© ê·¸ëŒ€ë¡œ -->
    <div class="container">
        <header>
            <h1>ğŸ¬ ìë§‰ ì˜¤ì—­ ìˆ˜ì • ë„êµ¬</h1>
            <p>Google Sheets ê¸°ë°˜ ìë™ ì˜¤ì—­ ìˆ˜ì • ì‹œìŠ¤í…œ</p>
        </header>

        <main>
            <!-- ê¸°ì¡´ ë‚´ìš© ê·¸ëŒ€ë¡œ -->
            <section class="connection-section">
                <h2>ğŸ“Š Google Sheets ì—°ê²°</h2>
                <input type="text" id="spreadsheet-url" placeholder="Google Sheets ê³µìœ  ë§í¬ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”">
                <button onclick="connectToSheets()">ì—°ê²°í•˜ê¸°</button>
                <div id="connection-status" class="status"></div>
            </section>

            <section class="dictionary-section">
                <h2>ğŸ“š ì˜¤ì—­ ì‚¬ì „ í˜„í™©</h2>
                <div class="dict-info">
                    <span>í˜„ì¬ ë“±ë¡ëœ ì˜¤ì—­ í•­ëª©: <strong id="dict-count">0</strong>ê°œ</span>
                    <button onclick="refreshDictionary()">ìƒˆë¡œê³ ì¹¨</button>
                </div>
                <div id="dict-preview" class="dict-preview"></div>
            </section>

            <section class="process-section">
    <h2>ğŸ­ ìë§‰ íŒŒì¼ ì²˜ë¦¬</h2>
    <div class="file-upload">
        <input type="file" id="subtitle-file" accept=".srt,.vtt">
        <button onclick="processFile()">ìë§‰ íŒŒì¼ ì²˜ë¦¬í•˜ê¸°</button>
    </div>
    
    <div class="text-areas">
        <div class="text-area-container">
            <h3>ì›ë³¸ ìë§‰</h3>
            <textarea id="original-subtitle" placeholder="ìë§‰ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”"></textarea>
        </div>
        <div class="text-area-container">
            <h3>ìˆ˜ì •ëœ ëŒ€ì‚¬ ëª©ë¡</h3>
            <textarea id="processed-subtitle" readonly placeholder="ìˆ˜ì •ëœ ëŒ€ì‚¬ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤"></textarea>
            <button onclick="downloadResult()">ë‹¤ìš´ë¡œë“œ</button>
        </div>
    </div>
    
    <!-- ì „ì²´ ìˆ˜ì •ëœ ìë§‰ ì €ì¥ìš© (ìˆ¨ê²¨ì§„ textarea) -->
    <textarea id="full-corrected-subtitle" style="display: none;"></textarea>
</section>

        </main>
    </div>

    <!-- Google APIë¥¼ ë™ì ìœ¼ë¡œ ë¡œë“œ -->
    <script src="config.js"></script>
    <script>
        // Google API ë™ì  ë¡œë”©
        function loadGoogleAPI() {
            const script = document.createElement('script');
            script.src = 'https://apis.google.com/js/api.js';
            script.onload = function() {
                initializeGoogleAPI();
            };
            script.onerror = function() {
                console.error('Google API ë¡œë“œ ì‹¤íŒ¨');
                updateConnectionStatus('Google API ë¡œë“œ ì‹¤íŒ¨', 'error');
            };
            document.head.appendChild(script);
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ API ë¡œë“œ
        window.addEventListener('load', loadGoogleAPI);
    </script>
    <script src="subtitle-processor.js"></script>
</body>
</html>
